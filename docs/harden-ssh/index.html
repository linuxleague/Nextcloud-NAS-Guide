<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/Nextcloud-NAS-Guide/news/rss.xml" title="Nextcloud-NAS-Guide Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Nextcloud-NAS-Guide/news/atom.xml" title="Nextcloud-NAS-Guide Blog Atom Feed"><title data-react-helmet="true">How to harden the SSH configuration? | Nextcloud-NAS-Guide</title><meta data-react-helmet="true" property="og:url" content="https://szaimen.github.io/Nextcloud-NAS-Guide/docs/harden-ssh"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="How to harden the SSH configuration? | Nextcloud-NAS-Guide"><meta data-react-helmet="true" name="description" content="Although you don&#x27;t port-forward SSH to the public internet (if you&#x27;ve followed this guide), which is BTW also really not recommended, you should nonetheless harden your SSH configuration to make SSH access for an attacker (e.g. from inside your home network) as hard as possible."><meta data-react-helmet="true" property="og:description" content="Although you don&#x27;t port-forward SSH to the public internet (if you&#x27;ve followed this guide), which is BTW also really not recommended, you should nonetheless harden your SSH configuration to make SSH access for an attacker (e.g. from inside your home network) as hard as possible."><link data-react-helmet="true" rel="shortcut icon" href="/Nextcloud-NAS-Guide/img/favicon.webp"><link data-react-helmet="true" rel="canonical" href="https://szaimen.github.io/Nextcloud-NAS-Guide/docs/harden-ssh"><link data-react-helmet="true" rel="alternate" href="https://szaimen.github.io/Nextcloud-NAS-Guide/docs/harden-ssh" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://szaimen.github.io/Nextcloud-NAS-Guide/docs/harden-ssh" hreflang="x-default"><link rel="stylesheet" href="/Nextcloud-NAS-Guide/assets/css/styles.2b2e5844.css">
<link rel="preload" href="/Nextcloud-NAS-Guide/assets/js/runtime~main.00bffd37.js" as="script">
<link rel="preload" href="/Nextcloud-NAS-Guide/assets/js/main.fc07e004.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Nextcloud-NAS-Guide/"><img src="/Nextcloud-NAS-Guide/img/favicon.webp" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/Nextcloud-NAS-Guide/img/favicon.webp" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Nextcloud-NAS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Nextcloud-NAS-Guide/docs/">Guide</a><a class="navbar__item navbar__link" href="/Nextcloud-NAS-Guide/news">News</a><a href="https://github.com/szaimen/Nextcloud-NAS-Guide/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_MM2z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_s5VG searchBarLoadingRing_2jQk"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Nextcloud-NAS-Guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Before you start</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Basic setup</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security and Automation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Backup</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">SMB-server</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Customize Nextcloud</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Activate Let&#x27;s Encrypt</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Optional</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/optional">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/firewall">Firewall</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/Nextcloud-NAS-Guide/docs/harden-ssh">Harden SSH</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/share-link-audit">Monitor link shares</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/onlyoffice">OnlyOffice</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/hpb">High-Performance backend for Nextcloud Talk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/notify_push">Push Notifications for Nextcloud</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/whiteboard">Whiteboard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/pico">Pico CMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/extract">Extract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/vaultwarden">Vaultwarden</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/pi-hole">Pi-hole</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/pivpn">PiVPN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/change-update-time">Change update time</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/home-access-only">Home access only</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/pms">PLEX Media Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/remotedesktop">Remotedesktop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/digitize">Digitize Blu-rays, DVDs &amp; CDs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Nextcloud-NAS-Guide/docs/more-apps">More apps</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">How to harden the SSH configuration?</h1></header><p>Although you don&#x27;t port-forward SSH to the public internet (if you&#x27;ve followed this guide), which is BTW also really not recommended, you should nonetheless harden your SSH configuration to make SSH access for an attacker (e.g. from inside your home network) as hard as possible. </p><p>Here is how to do this:</p><ol><li><p>Run over CLI:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"> /var/scripts/not-supported.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Choose <code>Harden SSH</code></p></li><li><p>Choose to install/reinstall Harden SSH</p></li><li><p>It should report now that SSH was successfully hardened</p></li><li><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>optional 2FA SSH authentication</h5></div><div class="admonition-content"><p>If you have a smartphone with an OTP app like Google Authenticator or password manager like Keepass or Bitwarden (or Vaultwarden), you can now choose to enable two-factor authentication for SSH connections. It is optional since you might will be no longer able to connect via SSH to your server if something goes wrong here.</p><ol><li>Choose <code>Yes</code> now to <strong>enable Two-factor authentication for SSH connections</strong></li><li>Scan the shown QR code with the OTP app and note down the emergency codes</li><li>Confirm that you&#x27;ve saved them</li></ol><p>Now, the next time you connect to your server via SSH, you will get asked for the OTP code which makes SSH much more secure.</p></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>You will loose access to your server via SSH if you don&#x27;t scan the QR code or note down the emergency codes. <br>
You can simply disable the 2FA authentication for SSH by running this script again.</p></div></div></li></ol><hr><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>If you want to make SSH as secure as possible, you can also use SSH-keys to access your server. Here is a good guide how to configure this: <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys-on-ubuntu-20-04" target="_blank" rel="noopener noreferrer">click here</a></p></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/szaimen/Nextcloud-NAS-Guide/edit/main/docs/harden-shh.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Nextcloud-NAS-Guide/docs/firewall"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Firewall</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Nextcloud-NAS-Guide/docs/share-link-audit"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Monitor link shares Â»</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Nextcloud-NAS-Guide/docs/impressum">Impressum</a></li><li class="footer__item"><a class="footer__link-item" href="/Nextcloud-NAS-Guide/docs/privacy">Privacy Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 <a href="https://github.com/szaimen">szaimen</a> - Built with Docusaurus.</div></div></div></footer></div>
<script src="/Nextcloud-NAS-Guide/assets/js/runtime~main.00bffd37.js"></script>
<script src="/Nextcloud-NAS-Guide/assets/js/main.fc07e004.js"></script>
</body>
</html>