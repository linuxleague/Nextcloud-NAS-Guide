"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2364],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return h}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=u(n),h=r,m=p["".concat(s,".").concat(h)]||p[h]||c[h]||o;return n?a.createElement(m,i(i({ref:t},d),{},{components:n})):a.createElement(m,i({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},1102:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return s},default:function(){return h},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return c}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],l={id:"create-shares",title:"How to create SMB-shares and mount it to Nextcloud in one go?",sidebar_label:"Create SMB-shares and mount it to Nextcloud"},s=void 0,u={unversionedId:"create-shares",id:"create-shares",title:"How to create SMB-shares and mount it to Nextcloud in one go?",description:"The big advantage is, that you can create a SMB-share and mount the same location to Nextcloud in one go.",source:"@site/docs/create-shares.md",sourceDirName:".",slug:"/create-shares",permalink:"/Nextcloud-NAS-Guide/docs/create-shares",draft:!1,editUrl:"https://github.com/szaimen/Nextcloud-NAS-Guide/edit/main/docs/create-shares.md",tags:[],version:"current",frontMatter:{id:"create-shares",title:"How to create SMB-shares and mount it to Nextcloud in one go?",sidebar_label:"Create SMB-shares and mount it to Nextcloud"},sidebar:"docs",previous:{title:"Create SMB-users and Nextcloud users",permalink:"/Nextcloud-NAS-Guide/docs/create-users"},next:{title:"Automatic recycle bin cleanup",permalink:"/Nextcloud-NAS-Guide/docs/recycle-bin-cleanup"}},d={},c=[],p={toc:c};function h(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The big advantage is, that you can create a SMB-share and mount the same location to Nextcloud in one go."),(0,o.kt)("p",null,"If you have followed this guide, you should have set up a ",(0,o.kt)("strong",{parentName:"p"},"sensible folder structure")," on the external data SSD/HDD by now. Based on this structure, you should ",(0,o.kt)("strong",{parentName:"p"},"share")," the ",(0,o.kt)("inlineCode",{parentName:"p"},"user folders")," with the corresponding user that you just created. The ",(0,o.kt)("inlineCode",{parentName:"p"},"data exchange")," folders should get shared with the users that shall have access to those folders. "),(0,o.kt)("p",null,"If you have mounted the external data SSD/HDD in ",(0,o.kt)("inlineCode",{parentName:"p"},"/mnt/data")," as recommended, is here one example:\nYour data folder should be now found in ",(0,o.kt)("inlineCode",{parentName:"p"},"/mnt/data/your data folder"),". One of your user folders and data exchange folders might be ",(0,o.kt)("inlineCode",{parentName:"p"},"/mnt/data/your data folder/user1 folder")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"/mnt/data/your data folder/Data exchange folder")," now. You should then ",(0,o.kt)("strong",{parentName:"p"},"share")," the ",(0,o.kt)("inlineCode",{parentName:"p"},"/mnt/data/your data folder/user1 folder")," with ",(0,o.kt)("inlineCode",{parentName:"p"},"user1")," and the ",(0,o.kt)("inlineCode",{parentName:"p"},"/mnt/data/your data folder/Data exchange folder")," with all users that shall get access to this folder. As you now see, best case is, if the user folders on your external data SSD/HDD match exactly the user count of newly created users."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"BTW"),": you can at this point still shutdown your server, disconnect the external data SSD/HDD, connect it to your PC, open it with ",(0,o.kt)("inlineCode",{parentName:"p"},"Veracrypt")," and change the folder structure there. (see ",(0,o.kt)("a",{parentName:"p",href:"./access-veracrypt"},"this link")," for further instructions). Afterwards you can connect the drive to your server again and power it back on.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Based on the example above, you should now create a list how do you want to share your data with your users.")),(0,o.kt)("p",null,"Here is how to work off this list technically:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Go back to the ",(0,o.kt)("strong",{parentName:"li"},"SMB-server Main Menu")," and select ",(0,o.kt)("inlineCode",{parentName:"li"},"Open the SMB-share Menu")),(0,o.kt)("li",{parentName:"ol"},"Choose ",(0,o.kt)("inlineCode",{parentName:"li"},"Create a SMB-share")),(0,o.kt)("li",{parentName:"ol"},"You will see now a list of valid directories you can type in"),(0,o.kt)("li",{parentName:"ol"},"Type in one ",(0,o.kt)("strong",{parentName:"li"},"directory")," that you want to share. Based on the example above, it could be e.g. ",(0,o.kt)("inlineCode",{parentName:"li"},"/mnt/data/your data folder/user1 folder")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"/mnt/data/your data folder/Data exchange folder")),(0,o.kt)("li",{parentName:"ol"},"Type in the ",(0,o.kt)("strong",{parentName:"li"},"Share name")," that you want to use. It should most likely have the same name like the folder that you want to share. Please note, that spaces are not supported. For e.g. ",(0,o.kt)("inlineCode",{parentName:"li"},"user1 folder")," you would thus need to use ",(0,o.kt)("inlineCode",{parentName:"li"},"user1_folder")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"user1-folder")," as name"),(0,o.kt)("li",{parentName:"ol"},"Now ",(0,o.kt)("strong",{parentName:"li"},"select the SMB-users")," that shall get ",(0,o.kt)("strong",{parentName:"li"},"access")," to the share. If it is a ",(0,o.kt)("inlineCode",{parentName:"li"},"user folder"),", you should only share it with the corresponding user. If it is a ",(0,o.kt)("inlineCode",{parentName:"li"},"Data exchange folder"),", you should share it with all users that shall get access to the folder."),(0,o.kt)("li",{parentName:"ol"},"Now select if the share shall be ",(0,o.kt)("strong",{parentName:"li"},"writeable"),", which you should most likely answer with ",(0,o.kt)("inlineCode",{parentName:"li"},"Yes")),(0,o.kt)("li",{parentName:"ol"},"After restarting Samba, the SMB-share should be successfully created!"),(0,o.kt)("li",{parentName:"ol"},"Select that you ",(0,o.kt)("strong",{parentName:"li"},"want to mount")," the same directory to Nextcloud as local storage (you are making the path that you've chosen in the beginning accessible in Nextcloud this way)"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("admonition",{parentName:"li",title:"user-folders",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"In the case of a ",(0,o.kt)("inlineCode",{parentName:"p"},"user folder"),", you will now be asked if you want to make the selected directory the ",(0,o.kt)("strong",{parentName:"p"},"root folder in Nextcloud")," for the selected user, which you should in most cases ",(0,o.kt)("strong",{parentName:"p"},"confirm")," by pressing ",(0,o.kt)("inlineCode",{parentName:"p"},"[ENTER]"),".",(0,o.kt)("br",null),(0,o.kt)("br",null),"\n(This will only be shown to you in the case of a ",(0,o.kt)("inlineCode",{parentName:"p"},"user folder"),", not for ",(0,o.kt)("inlineCode",{parentName:"p"},"Data exchange folders")," and also not if you've made the directory ",(0,o.kt)("strong",{parentName:"p"},"read only"),". Only select ",(0,o.kt)("inlineCode",{parentName:"p"},"[NO]")," here if you've already made another directory the root folder for the selected user before.)"))),(0,o.kt)("li",{parentName:"ol"},"Now everything should get set up automatically"),(0,o.kt)("li",{parentName:"ol"},"Enabling Inotify is ",(0,o.kt)("strong",{parentName:"li"},"not")," recommended and normally not necessary")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Now repeat that method for the whole list that you've made, starting at point 2.")),(0,o.kt)("p",null,"After you've done with all shares, you can exit the SMB-server script by selecting ",(0,o.kt)("inlineCode",{parentName:"p"},"Return")," -> ",(0,o.kt)("inlineCode",{parentName:"p"},"Exit")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Please note that you can always change the settings for your mounts in Nextcloud by opening ",(0,o.kt)("inlineCode",{parentName:"p"},"https://yourdomain-or-ipaddress/settings/admin/externalstorages")," with your Nextcloud admin account afterwards.")),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Your users should now be able to access their files and folders using SMB over the local network.",(0,o.kt)("br",null),"\nHere are instructions how to do this in detail: ",(0,o.kt)("a",{parentName:"p",href:"./smb-connect"},"click here"))))}h.isMDXComponent=!0}}]);