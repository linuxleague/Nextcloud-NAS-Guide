"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6646],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return m}});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var u=o.createContext({}),s=function(e){var t=o.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=s(e.components);return o.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,u=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=s(a),m=n,h=c["".concat(u,".").concat(m)]||c[m]||d[m]||r;return a?o.createElement(h,i(i({ref:t},p),{},{components:a})):o.createElement(h,i({ref:t},p))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=c;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var s=2;s<r;s++)i[s]=a[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,a)}c.displayName="MDXCreateElement"},3628:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return u},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return d}});var o=a(7462),n=a(3366),r=(a(7294),a(3905)),i=["components"],l={id:"major-update",title:"How to update your Nextcloud manually to a major version?",sidebar_label:"Major Nextcloud Update"},u=void 0,s={unversionedId:"major-update",id:"major-update",title:"How to update your Nextcloud manually to a major version?",description:"As already stated during the configuration of automatic updates, you need to update your server to major versions manually. You should automatically get notified by Mail and Nextcloud notification if a new major version was found.",source:"@site/docs/major-update.md",sourceDirName:".",slug:"/major-update",permalink:"/Nextcloud-NAS-Guide/docs/major-update",draft:!1,editUrl:"https://github.com/szaimen/Nextcloud-NAS-Guide/edit/main/docs/major-update.md",tags:[],version:"current",frontMatter:{id:"major-update",title:"How to update your Nextcloud manually to a major version?",sidebar_label:"Major Nextcloud Update"},sidebar:"docs",previous:{title:"Reduce power consumption",permalink:"/Nextcloud-NAS-Guide/docs/reduce-power-consumption"},next:{title:"Create new users after initial setup",permalink:"/Nextcloud-NAS-Guide/docs/create-new-users"}},p={},d=[{value:"Things to check before updating",id:"things-to-check-before-updating",level:3},{value:"Preparation",id:"preparation",level:3},{value:"Execution",id:"execution",level:3}],c={toc:d};function m(e){var t=e.components,a=(0,n.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"As already stated during the configuration of automatic updates, you need to update your server to major versions manually. You should automatically get notified by Mail and Nextcloud notification if a new major version was found. "),(0,r.kt)("h3",{id:"things-to-check-before-updating"},"Things to check before updating"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Never update to the first Nextcloud release like e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"21.0.0"),"! Although the Nextcloud GmbH states that all releases are stable, you should always wait at least for the first point release, e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"21.0.1")," before upgrading to a major version!"),(0,r.kt)("admonition",{parentName:"li",type:"note"},(0,r.kt)("p",{parentName:"admonition"},"You can check the latest releases here: (",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nextcloud/server/tags"},"click here"),")"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Check that all apps that you need are compatible with the new major version:",(0,r.kt)("br",null),"\nOpen ",(0,r.kt)("inlineCode",{parentName:"p"},"https://yourdomain.com/settings/admin/overview")," with the admin account."),(0,r.kt)("admonition",{parentName:"li",title:"Major version doesn't get shown",type:"note"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"If the update to the major version doesn't get shown to you, do the following:",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"Scroll down and change the ",(0,r.kt)("inlineCode",{parentName:"li"},"Update Channel")," from ",(0,r.kt)("strong",{parentName:"li"},"Stable")," to ",(0,r.kt)("strong",{parentName:"li"},"Beta")," (Don't worry, this won't change any important setting on your installation)"),(0,r.kt)("li",{parentName:"ol"},"Reload the page"),(0,r.kt)("li",{parentName:"ol"},"You should see now that a new Nextcloud major version was found e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"21.0.1")," (if you are on Nextcloud 20)"),(0,r.kt)("li",{parentName:"ol"},"It should also show to you if all installed apps have updates available for the new version or if some apps still miss updates for the new version."),(0,r.kt)("li",{parentName:"ol"},"If all apps that you depend on have updates available for the new version, you are ready to upgrade!"),(0,r.kt)("li",{parentName:"ol"},"Now you are free to switch the ",(0,r.kt)("inlineCode",{parentName:"li"},"Update Channel")," from ",(0,r.kt)("strong",{parentName:"li"},"Beta")," back to ",(0,r.kt)("strong",{parentName:"li"},"Stable")," (But as I've stated before: this setting won't change anything important on your installation)"))))),(0,r.kt)("admonition",{parentName:"li",title:"Major version gets shown",type:"note"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"If the update to the major version gets shown to you, do the following:",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"You should see now that a new Nextcloud major version was found e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"21.0.7")," (if you are on Nextcloud 20)"),(0,r.kt)("li",{parentName:"ol"},"It should also show to you if all installed apps have updates available for the new version or if some apps still miss updates for the new version."),(0,r.kt)("li",{parentName:"ol"},"If all apps that you depend on have updates available for the new version, you are ready to upgrade!"))))))),(0,r.kt)("hr",null),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"If at least the first point release is out and you've checked that all apps have updates available for the new major Nextcloud version, you are ready to continue.")),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"preparation"},"Preparation"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create a Backup before updating (",(0,r.kt)("a",{parentName:"li",href:"./manual-backup"},"instructions"),")",(0,r.kt)("br",null),"\n(Although the update is already tested, it could fail, you never know! So better to create a current backup!)",(0,r.kt)("br",null),"\n(The update script itself will create a backup on its own but better to be double-safe.)")),(0,r.kt)("h3",{id:"execution"},"Execution"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Run over CLI:",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo bash /var/scripts/update.sh\n"))),(0,r.kt)("li",{parentName:"ol"},"Wait until the update has run and it reports that the update was successful."),(0,r.kt)("li",{parentName:"ol"},"Wait until the server automatically reboots")),(0,r.kt)("p",null,"Now you should have successfully updated to a new major Nextcloud version!"),(0,r.kt)("admonition",{title:"Mimetype database update",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"After a successful update, you should consider updating Nextclouds mimetype database. This is not done automatically and should be done after every successful major Nextcloud update to propagate all changed mimetypes into Nextcloud. Here is how to do this:"),(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"Run over CLI:",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo bash /var/scripts/menu.sh\n"))),(0,r.kt)("li",{parentName:"ol"},"Choose ",(0,r.kt)("inlineCode",{parentName:"li"},"Nextcloud Configuration")," -> ",(0,r.kt)("inlineCode",{parentName:"li"},"Update mimetype list")),(0,r.kt)("li",{parentName:"ol"},"Choose ",(0,r.kt)("inlineCode",{parentName:"li"},"Yes")," to update the mimetype database."))),(0,r.kt)("hr",null),(0,r.kt)("admonition",{title:"failed updates",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"If the update has failed for you, you can easily restore your system from the backup that you've just created by following these steps: ",(0,r.kt)("a",{parentName:"p",href:"./restore-system"},"click here"))))}m.isMDXComponent=!0}}]);